½
^C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Controllers\RoleController.cs
	namespace		 	
RoleService		
 
.		 
Controllers		 !
{

 
[ 
Produces 
( 
MediaTypeNames 
. 
Application (
.( )
Json) -
)- .
]. /
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
RoleController 
:  !
ControllerBase" 0
{ 
private 
readonly 
IRoleRepository (
_roleRepository) 8
;8 9
public 
RoleController 
( 
IRoleRepository -
roleRepository. <
,< =
IUserRoleRepository> Q
userRoleRepositoryR d
)d e
{ 	
_roleRepository 
= 
roleRepository ,
;, -
} 	
[ 	
HttpGet	 
] 
[ 	 
ProducesResponseType	 
( 
StatusCodes )
.) *
Status200OK* 5
)5 6
]6 7
public 
IActionResult 
GetAll #
(# $
)$ %
{ 	
return 
Ok 
( 
_roleRepository %
.% &
GetAll& ,
(, -
)- .
). /
;/ 0
} 	
[ 	
HttpPost	 
] 
[ 	 
ProducesResponseType	 
( 
StatusCodes )
.) *
Status201Created* :
): ;
]; <
public   
ActionResult   
<   
Role    
>    !
Create  " (
(  ( )
[  ) *
FromBody  * 2
]  2 3
CreateRoleRequest  4 E
request  F M
)  M N
{!! 	
Role"" 
role"" 
="" 
new"" 
Role""  
{## 
Name$$ 
=$$ 
request$$ 
.$$ 
Name$$ #
,$$# $

CreateDate%% 
=%% 
DateTime%% %
.%%% &
Now%%& )
}&& 
;&& 
_roleRepository(( 
.(( 
Create(( "
(((" #
role((# '
)((' (
;((( )
return** 
Created** 
(** 
nameof** !
(**! "
Role**" &
)**& '
,**' (
role**) -
)**- .
;**. /
}++ 	
[-- 	

HttpDelete--	 
(-- 
$str-- 
)-- 
]-- 
[.. 	 
ProducesResponseType..	 
(.. 
StatusCodes.. )
...) *
Status404NotFound..* ;
)..; <
]..< =
[// 	 
ProducesResponseType//	 
(// 
StatusCodes// )
.//) *
Status200OK//* 5
)//5 6
]//6 7
public00 
ActionResult00 
<00 
Role00  
>00  !
Delete00" (
(00( )
Guid00) -
id00. 0
)000 1
{11 	
Role22 
role22 
=22 
_roleRepository22 '
.22' (
GetById22( /
(22/ 0
id220 2
)222 3
;223 4
if33 
(33 
role33 
==33 
null33 
)33 
{44 
return55 
NotFound55 
(55  
$str55  0
)550 1
;551 2
}66 
_roleRepository88 
.88 
Remove88 "
(88" #
id88# %
)88% &
;88& '
return:: 
Ok:: 
(:: 
):: 
;:: 
};; 	
}<< 
}== È.
bC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Controllers\UserRoleController.cs
	namespace		 	
RoleService		
 
.		 
Controllers		 !
{

 
[ 
Produces 
( 
MediaTypeNames 
. 
Application (
.( )
Json) -
)- .
]. /
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
UserRoleController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
IRoleRepository (
_roleRepository) 8
;8 9
private 
readonly 
IUserRepository (
_userRepository) 8
;8 9
private 
readonly 
IUserRoleRepository ,
_userRoleRepository- @
;@ A
public 
UserRoleController !
(! "
IRoleRepository 
roleRepository *
,* +
IUserRepository 
userRepository *
,* +
IUserRoleRepository 
userRoleRepository  2
) 	
{
 
_roleRepository 
= 
roleRepository ,
;, -
_userRepository 
= 
userRepository ,
;, -
_userRoleRepository 
=  !
userRoleRepository" 4
;4 5
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
[ 	 
ProducesResponseType	 
( 
StatusCodes )
.) *
Status201Created* :
): ;
]; <
public   
ActionResult   
<   
Role    
>    !
GetUserRoles  " .
(  . /
Guid  / 3
userId  4 :
)  : ;
{!! 	
User"" 
user"" 
="" 
_userRepository"" '
.""' (
GetById""( /
(""/ 0
userId""0 6
)""6 7
;""7 8
if## 
(## 
user## 
==## 
null## 
)## 
{$$ 
return%% 
NotFound%% 
(%%  
$str%%  0
)%%0 1
;%%1 2
}&& 
return(( 
Ok(( 
((( 
_userRoleRepository(( )
.(() *
GetUserRoles((* 6
(((6 7
userId((7 =
)((= >
)((> ?
;((? @
})) 	
[++ 	
HttpPost++	 
]++ 
[,, 	 
ProducesResponseType,,	 
(,, 
StatusCodes,, )
.,,) *
Status201Created,,* :
),,: ;
],,; <
public-- 
ActionResult-- 
<-- 
Role--  
>--  !
CreateUserRole--" 0
(--0 1
[--1 2
FromBody--2 :
]--: ;!
CreateUserRoleRequest--< Q
request--R Y
)--Y Z
{.. 	
Role// 
role// 
=// 
_roleRepository// '
.//' (
GetById//( /
(/// 0
request//0 7
.//7 8
RoleId//8 >
)//> ?
;//? @
if00 
(00 
role00 
==00 
null00 
)00 
{11 
return22 
NotFound22 
(22  
$str22  0
)220 1
;221 2
}33 
User55 
user55 
=55 
_userRepository55 '
.55' (
GetById55( /
(55/ 0
request550 7
.557 8
UserId558 >
)55> ?
;55? @
if66 
(66 
user66 
==66 
null66 
)66 
{77 
user88 
=88 
new88 
User88 
{99 
Id:: 
=:: 
request::  
.::  !
UserId::! '
};; 
;;; 
_userRepository<< 
.<<  
Create<<  &
(<<& '
user<<' +
)<<+ ,
;<<, -
}== 
UserRole?? 
userRole?? 
=?? 
new??  #
UserRole??$ ,
{@@ 
UserIdAA 
=AA 
requestAA  
.AA  !
UserIdAA! '
,AA' (
RoleIdBB 
=BB 
requestBB  
.BB  !
RoleIdBB! '
,BB' (

CreateDateCC 
=CC 
DateTimeCC %
.CC% &
NowCC& )
}DD 
;DD 
_userRoleRepositoryFF 
.FF  
CreateFF  &
(FF& '
userRoleFF' /
)FF/ 0
;FF0 1
returnHH 
CreatedHH 
(HH 
nameofHH !
(HH! "
UserRoleHH" *
)HH* +
,HH+ ,
nullHH- 1
)HH1 2
;HH2 3
}II 	
[KK 	

HttpDeleteKK	 
(KK 
$strKK 
)KK 
]KK 
[LL 	 
ProducesResponseTypeLL	 
(LL 
StatusCodesLL )
.LL) *
Status404NotFoundLL* ;
)LL; <
]LL< =
[MM 	 
ProducesResponseTypeMM	 
(MM 
StatusCodesMM )
.MM) *
Status200OKMM* 5
)MM5 6
]MM6 7
publicNN 
ActionResultNN 
<NN 
RoleNN  
>NN  !
DeleteNN" (
(NN( )
GuidNN) -
idNN. 0
,NN0 1
DeleteRoleRequestNN2 C
requestNND K
)NNK L
{OO 	
throwPP 
newPP #
NotImplementedExceptionPP -
(PP- .
)PP. /
;PP/ 0
}QQ 	
}RR 
}SS î	
]C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Data\RolesDatabaseContext.cs
	namespace 	
RoleService
 
. 
Data 
{ 
public 

class  
RolesDatabaseContext %
:& '
	DbContext( 1
{ 
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
DbSet		 
<		 
Role		 
>		 
Roles		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
DbSet

 
<

 
UserRole

 
>

 
	UserRoles

 (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
public  
RolesDatabaseContext #
(# $
DbContextOptions$ 4
<4 5 
RolesDatabaseContext5 I
>I J
optionsK R
)R S
:T U
baseV Z
(Z [
options[ b
)b c
{ 	
} 	
} 
} ×
ZC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\DTOs\CreateRoleRequest.cs
	namespace 	
RoleService
 
. 
DTOs 
{ 
public 

class 
CreateRoleRequest "
:# $
IRequest% -
<- .
Role. 2
>2 3
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 1
)1 2
]2 3
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 

CreateDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} Ð
^C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\DTOs\CreateUserRoleRequest.cs
	namespace 	
RoleService
 
. 
DTOs 
{ 
public 

class !
CreateUserRoleRequest &
:' (
IRequest) 1
<1 2
Role2 6
>6 7
{		 
[

 	
Required

	 
(

 
ErrorMessage

 
=

  
$str

! 1
)

1 2
]

2 3
public 
Guid 
UserId 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 1
)1 2
]2 3
public 
Guid 
RoleId 
{ 
get  
;  !
set" %
;% &
}' (
} 
} 
ZC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\DTOs\DeleteRoleRequest.cs
	namespace 	
RoleService
 
. 
DTOs 
{ 
public 

class 
DeleteRoleRequest "
:" #
IRequest$ ,
<, -
Role- 1
>1 2
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
} 
} ñ8
nC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Migrations\20210411144911_InitialMigration.cs
	namespace 	
tfg_role_service
 
. 

Migrations %
{ 
public 

partial 
class 
InitialMigration )
:* +
	Migration, 5
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
type, 0
:0 1
$str2 D
,D E
nullableF N
:N O
falseP U
)U V
,V W
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X

CreateDate 
=  
table! &
.& '
Column' -
<- .
DateTime. 6
>6 7
(7 8
type8 <
:< =
$str> I
,I J
nullableK S
:S T
falseU Z
)Z [
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% /
,/ 0
x1 2
=>3 5
x6 7
.7 8
Id8 :
): ;
;; <
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
type, 0
:0 1
$str2 D
,D E
nullableF N
:N O
falseP U
)U V
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% /
,/ 0
x1 2
=>3 5
x6 7
.7 8
Id8 :
): ;
;; <
}   
)   
;   
migrationBuilder"" 
."" 
CreateTable"" (
(""( )
name## 
:## 
$str## !
,##! "
columns$$ 
:$$ 
table$$ 
=>$$ !
new$$" %
{%% 
Id&& 
=&& 
table&& 
.&& 
Column&& %
<&&% &
Guid&&& *
>&&* +
(&&+ ,
type&&, 0
:&&0 1
$str&&2 D
,&&D E
nullable&&F N
:&&N O
false&&P U
)&&U V
,&&V W
UserId'' 
='' 
table'' "
.''" #
Column''# )
<'') *
Guid''* .
>''. /
(''/ 0
type''0 4
:''4 5
$str''6 H
,''H I
nullable''J R
:''R S
false''T Y
)''Y Z
,''Z [
RoleId(( 
=(( 
table(( "
.((" #
Column((# )
<(() *
Guid((* .
>((. /
(((/ 0
type((0 4
:((4 5
$str((6 H
,((H I
nullable((J R
:((R S
false((T Y
)((Y Z
,((Z [

CreateDate)) 
=))  
table))! &
.))& '
Column))' -
<))- .
DateTime)). 6
>))6 7
())7 8
type))8 <
:))< =
$str))> I
,))I J
nullable))K S
:))S T
false))U Z
)))Z [
}** 
,** 
constraints++ 
:++ 
table++ "
=>++# %
{,, 
table-- 
.-- 

PrimaryKey-- $
(--$ %
$str--% 3
,--3 4
x--5 6
=>--7 9
x--: ;
.--; <
Id--< >
)--> ?
;--? @
table.. 
... 

ForeignKey.. $
(..$ %
name// 
:// 
$str// 9
,//9 :
column00 
:00 
x00  !
=>00" $
x00% &
.00& '
RoleId00' -
,00- .
principalTable11 &
:11& '
$str11( /
,11/ 0
principalColumn22 '
:22' (
$str22) -
,22- .
onDelete33  
:33  !
ReferentialAction33" 3
.333 4
Cascade334 ;
)33; <
;33< =
table44 
.44 

ForeignKey44 $
(44$ %
name55 
:55 
$str55 9
,559 :
column66 
:66 
x66  !
=>66" $
x66% &
.66& '
UserId66' -
,66- .
principalTable77 &
:77& '
$str77( /
,77/ 0
principalColumn88 '
:88' (
$str88) -
,88- .
onDelete99  
:99  !
ReferentialAction99" 3
.993 4
Cascade994 ;
)99; <
;99< =
}:: 
):: 
;:: 
migrationBuilder<< 
.<< 
CreateIndex<< (
(<<( )
name== 
:== 
$str== +
,==+ ,
table>> 
:>> 
$str>> "
,>>" #
column?? 
:?? 
$str??  
)??  !
;??! "
migrationBuilderAA 
.AA 
CreateIndexAA (
(AA( )
nameBB 
:BB 
$strBB +
,BB+ ,
tableCC 
:CC 
$strCC "
,CC" #
columnDD 
:DD 
$strDD  
)DD  !
;DD! "
}EE 	
	protectedGG 
overrideGG 
voidGG 
DownGG  $
(GG$ %
MigrationBuilderGG% 5
migrationBuilderGG6 F
)GGF G
{HH 	
migrationBuilderII 
.II 
	DropTableII &
(II& '
nameJJ 
:JJ 
$strJJ !
)JJ! "
;JJ" #
migrationBuilderLL 
.LL 
	DropTableLL &
(LL& '
nameMM 
:MM 
$strMM 
)MM 
;MM 
migrationBuilderOO 
.OO 
	DropTableOO &
(OO& '
namePP 
:PP 
$strPP 
)PP 
;PP 
}QQ 	
}RR 
}SS 
TC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Models\BaseModel.cs
	namespace 	
RoleService
 
. 
Models 
{ 
public 

class 
	BaseModel 
{ 
} 
}		 í
OC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Models\Role.cs
	namespace 	
RoleService
 
. 
Models 
{ 
public 

class 
Role 
: 
	BaseModel !
{ 
public		 
Guid		 
Id		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
[

 	
Required

	 
]

 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
] 
public 
DateTime 

CreateDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} Í
OC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Models\User.cs
	namespace 	
RoleService
 
. 
Models 
{ 
public 

class 
User 
: 
	BaseModel !
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
} 
}		 Ñ	
SC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Models\UserRole.cs
	namespace 	
RoleService
 
. 
Models 
{ 
public 

class 
UserRole 
: 
	BaseModel %
{		 
public

 
Guid

 
Id

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 
Guid 
UserId 
{ 
get  
;  !
set" %
;% &
}' (
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
public 
Guid 
RoleId 
{ 
get  
;  !
set" %
;% &
}' (
public 
Role 
Role 
{ 
get 
; 
set  #
;# $
}% &
public 
DateTime 

CreateDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} 
KC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Program.cs
	namespace

 	
RoleService


 
{ 
public 

class 
Program 
{ 
	protected 
Program 
( 
) 
{ 
} 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ü
\C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\IRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public 

	interface 
IRepository  
<  !
TModel! '
>' (
where) .
TModel/ 5
:6 7
class8 =
{ 
IEnumerable 
< 
TModel 
> 
GetAll "
(" #
)# $
;$ %
public		 
void		 
Create		 
(		 
TModel		 !
entity		" (
)		( )
;		) *
public

 
TModel

 
GetById

 
(

 
Guid

 "
id

# %
)

% &
;

& '
public 
void 
Remove 
( 
Guid 
id  "
)" #
;# $
} 
} 
`C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\IRoleRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public 

	interface 
IRoleRepository $
:% &
IRepository' 2
<2 3
Role3 7
>7 8
{ 
} 
}		 
`C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\IUserRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public 

	interface 
IUserRepository $
:% &
IRepository' 2
<2 3
User3 7
>7 8
{ 
} 
}		 ç
dC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\IUserRoleRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public 

	interface 
IUserRoleRepository (
:) *
IRepository+ 6
<6 7
UserRole7 ?
>? @
{ 
public		 
IEnumerable		 
<		 
Role		 
>		  
GetUserRoles		! -
(		- .
Guid		. 2
userId		3 9
)		9 :
;		: ;
}

 
} Ï
_C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\RoleRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public		 

class		 
RoleRepository		 
:		  !
IRoleRepository		" 1
{

 
private 
readonly  
RolesDatabaseContext -
_context. 6
;6 7
public 
RoleRepository 
(  
RolesDatabaseContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
IEnumerable 
< 
Role 
>  
GetAll! '
(' (
)( )
{ 	
return 
_context 
. 
Roles !
.! "
ToList" (
(( )
)) *
;* +
} 	
public 
Role 
GetById 
( 
Guid  
id! #
)# $
{ 	
return 
_context 
. 
Roles !
.! "
Find" &
(& '
id' )
)) *
;* +
} 	
public 
void 
Create 
( 
Role 
entity  &
)& '
{ 	
_context 
. 
Roles 
. 
Add 
( 
entity %
)% &
;& '
_context 
. 
SaveChanges  
(  !
)! "
;" #
}   	
public"" 
void"" 
Remove"" 
("" 
Guid"" 
id""  "
)""" #
{## 	
Role$$ 
role$$ 
=$$ 
_context$$  
.$$  !
Roles$$! &
.$$& '
Find$$' +
($$+ ,
id$$, .
)$$. /
;$$/ 0
_context&& 
.&& 
Roles&& 
.&& 
Remove&& !
(&&! "
role&&" &
)&&& '
;&&' (
_context'' 
.'' 
SaveChanges''  
(''  !
)''! "
;''" #
}(( 	
})) 
}** Ï
_C:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\UserRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public		 

class		 
UserRepository		 
:		  !
IUserRepository		" 1
{

 
private 
readonly  
RolesDatabaseContext -
_context. 6
;6 7
public 
UserRepository 
(  
RolesDatabaseContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
IEnumerable 
< 
User 
>  
GetAll! '
(' (
)( )
{ 	
return 
_context 
. 
Users !
.! "
ToList" (
(( )
)) *
;* +
} 	
public 
User 
GetById 
( 
Guid  
id! #
)# $
{ 	
return 
_context 
. 
Users !
.! "
Find" &
(& '
id' )
)) *
;* +
} 	
public 
void 
Create 
( 
User 
entity  &
)& '
{ 	
_context 
. 
Users 
. 
Add 
( 
entity %
)% &
;& '
_context 
. 
SaveChanges  
(  !
)! "
;" #
}   	
public"" 
void"" 
Remove"" 
("" 
Guid"" 
id""  "
)""" #
{## 	
User$$ 
user$$ 
=$$ 
_context$$  
.$$  !
Users$$! &
.$$& '
Find$$' +
($$+ ,
id$$, .
)$$. /
;$$/ 0
_context&& 
.&& 
Users&& 
.&& 
Remove&& !
(&&! "
user&&" &
)&&& '
;&&' (
_context'' 
.'' 
SaveChanges''  
(''  !
)''! "
;''" #
}(( 	
})) 
}** 
cC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Repositories\UserRoleRepository.cs
	namespace 	
RoleService
 
. 
Repositories "
{ 
public		 

class		 
UserRoleRepository		 #
:		$ %
IUserRoleRepository		& 9
{

 
private 
readonly  
RolesDatabaseContext -
_context. 6
;6 7
public 
UserRoleRepository !
(! " 
RolesDatabaseContext" 6
context7 >
)> ?
{ 	
_context 
= 
context 
; 
} 	
public 
IEnumerable 
< 
UserRole #
># $
GetAll% +
(+ ,
), -
{ 	
return 
_context 
. 
	UserRoles %
.% &
ToList& ,
(, -
)- .
;. /
} 	
public 
UserRole 
GetById 
(  
Guid  $
id% '
)' (
{ 	
return 
_context 
. 
	UserRoles %
.% &
Find& *
(* +
id+ -
)- .
;. /
} 	
public 
void 
Create 
( 
UserRole #
entity$ *
)* +
{ 	
_context 
. 
	UserRoles 
. 
Add "
(" #
entity# )
)) *
;* +
_context 
. 
SaveChanges  
(  !
)! "
;" #
}   	
public"" 
void"" 
Remove"" 
("" 
Guid"" 
id""  "
)""" #
{## 	
Role$$ 
role$$ 
=$$ 
_context$$  
.$$  !
Roles$$! &
.$$& '
Find$$' +
($$+ ,
id$$, .
)$$. /
;$$/ 0
_context&& 
.&& 
Roles&& 
.&& 
Remove&& !
(&&! "
role&&" &
)&&& '
;&&' (
_context'' 
.'' 
SaveChanges''  
(''  !
)''! "
;''" #
}(( 	
public** 
IEnumerable** 
<** 
Role** 
>**  
GetUserRoles**! -
(**- .
Guid**. 2
userId**3 9
)**9 :
{++ 	
var,, 
x,, 
=,, 
from,, 
u,, 
in,, 
_context,, &
.,,& '
Users,,' ,
from-- 
r-- 
in-- 
_context-- &
.--& '
Roles--' ,
from.. 
ur.. 
in.. 
_context.. '
...' (
	UserRoles..( 1
where// 
u// 
.// 
Id// 
==// !
userId//" (
where00 
u00 
.00 
Id00 
==00 !
ur00" $
.00$ %
UserId00% +
where11 
r11 
.11 
Id11 
==11 !
ur11" $
.11$ %
RoleId11% +
select22 
r22 
;22 
return44 
x44 
.44 
ToList44 
<44 
Role44  
>44  !
(44! "
)44" #
;44# $
}55 	
}66 
}77 Ì 
KC:\Users\eucar\OneDrive\Desktop\Servicii dotnet\tfg-role-service\Startup.cs
	namespace 	
RoleService
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddMvc 
( 
options #
=>$ &
{ 
options 
. 
MaxValidationDepth *
=+ ,
null- 1
;1 2
} 
) 
; 
services!! 
.!! 

AddMediatR!! 
(!!  
typeof!!  &
(!!& '
Startup!!' .
)!!. /
)!!/ 0
;!!0 1
services## 
.## 
AddControllers## #
(### $
)##$ %
;##% &
services%% 
.%% 
	AddScoped%% 
<%% 

IUrlHelper%% )
>%%) *
(%%* +
factory%%+ 2
=>%%3 5
{&& 
var'' 
actionContext'' !
=''" #
factory''$ +
.''+ ,

GetService'', 6
<''6 7"
IActionContextAccessor''7 M
>''M N
(''N O
)''O P
.((+ ,
ActionContext((, 9
;((9 :
return)) 
new)) 
	UrlHelper)) $
())$ %
actionContext))% 2
)))2 3
;))3 4
}** 
)** 
;** 
services,, 
.,, 
AddDbContext,, !
<,,! " 
RolesDatabaseContext,," 6
>,,6 7
(,,7 8
options,,8 ?
=>,,@ B
options-- 
.-- 
UseSqlServer-- $
(--$ %
Configuration--% 2
.--2 3
GetConnectionString--3 F
(--F G
$str--G ]
)--] ^
)--^ _
).. 
;.. 
services00 
.00 
	AddScoped00 
<00 
IRoleRepository00 .
,00. /
RoleRepository000 >
>00> ?
(00? @
)00@ A
;00A B
services11 
.11 
	AddScoped11 
<11 
IUserRoleRepository11 2
,112 3
UserRoleRepository114 F
>11F G
(11G H
)11H I
;11I J
services22 
.22 
	AddScoped22 
<22 
IUserRepository22 .
,22. /
UserRepository220 >
>22> ?
(22? @
)22@ A
;22A B
}33 	
public66 
void66 
	Configure66 
(66 
IApplicationBuilder66 1
app662 5
,665 6
IWebHostEnvironment667 J
env66K N
)66N O
{77 	
if88 
(88 
env88 
.88 
IsDevelopment88 !
(88! "
)88" #
)88# $
{99 
app:: 
.:: %
UseDeveloperExceptionPage:: -
(::- .
)::. /
;::/ 0
};; 
app== 
.== 
UseHttpsRedirection== #
(==# $
)==$ %
;==% &
app?? 
.?? 

UseRouting?? 
(?? 
)?? 
;?? 
appAA 
.AA 
UseAuthorizationAA  
(AA  !
)AA! "
;AA" #
appCC 
.CC 
UseEndpointsCC 
(CC 
	endpointsCC &
=>CC' )
{DD 
	endpointsEE 
.EE 
MapControllersEE (
(EE( )
)EE) *
;EE* +
}FF 
)FF 
;FF 
}GG 	
}HH 
}II 